<!DOCTYPE html>
<html>
<head>
    <title>Xác minh IP</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>Xác minh IP</h1>
    <p id="ip-status">Đang lấy IP...</p>
    <button id="send-ip" style="display: none;">Gửi IP</button>

    <script>
        const statusElement = document.getElementById("ip-status");
        const sendButton = document.getElementById("send-ip");

        // Đảm bảo Telegram Web App sẵn sàng
        Telegram.WebApp.ready();

        // Lấy IP từ API
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                const ip = data.ip;
                statusElement.textContent = `IP của bạn: ${ip}`;
                sendButton.style.display = "block";

                // Gửi IP về bot khi bấm nút
                sendButton.addEventListener("click", () => {
                    const ipData = JSON.stringify({ ip: ip });
                    statusElement.textContent = "Đang gửi IP...";
                    Telegram.WebApp.sendData(ipData); // Gửi dữ liệu về bot
                    Telegram.WebApp.close(); // Đóng mini app ngay sau khi gửi
                });
            })
            .catch(error => {
                statusElement.textContent = "Lỗi khi lấy IP: " + error.message;
            });
    </script>
</body>
</html>
